<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Learn Git with beginner to advanced Git tutorials on workflows, git commands, git migration and code review.">
<meta name="author" content="Atlassian">
<link rel="canonical" href="https://www.atlassian.com/git"/>
<title>Kikaha documentation</title>
<link rel="stylesheet" href="site.css"/>
<link href="https://fonts.googleapis.com/css?family=Sanchez:200,300,400,600" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">
<script src="showdown.min.js">
<script src="showdown-github.min.js">
<script>

</script>
</head>
<body class="wac git-home git">
<div class="header">
  <div class="container">
    <span class="k">k</span>
    <h1>Kikaha</h1>
    <a href="https://blog.kikaha.io">blog</a>
    <a href="https://github.com/Skullabs/kikaha">source code</a>
  </div>
</div>

<div class="page-wrap">
<div class="home-section home-about home-start">
<div class="g-row container">

<div class="g-column g-7-12 t-6-12 m-12-12">
<!-- CONTENT -->
<p>Connection Pool is a convenient way to deal with JDBC connections and provide nice and efficient performance to the application at all. ViburDBCP is an impressively fast and lightweight Database Connection Pool which Kikaha's Database module provides tight integration with. Include <code>kikaha-db</code> module on your project in order to have this feature enabled.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;artifactId&gt;kikaha-db&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h2 id="configuringthedatabasemodule">Configuring the database module</h2>
<p>All <em>DataSource</em> configurations are made through the <code>server.db.datasources</code> entry point at the <code>application.conf</code>. Note that, on 2.0.x and earlier versions this configuration were available at <code>server.datasources</code>.</p>
<pre><code class="yml language-yml">server:
  db:
    datasources:
      default:
        log-query-execution-longer-than-ms: 20
        log-stacktrace-for-long-query-execution: false
        default-auto-commit: true
        jdbc-url: "jdbc:mysql://db.corp.com/test_db"
        username: "username"
        password: "p@5zw0rd"

      production:
        jdbc-url: "jdbc:mysql://db.corp.com/test_db"
        username: "username"
        password: "p@5zw0rd"

      development:
        jdbc-url: "jdbc:mysql://localhost/test_db"
        username: "root"
        password: ""
</code></pre>
<p>Above we have a sample DataSource configuration named <code>production</code>, another one named <code>development</code>, and a third one named <code>default</code>. As you can see, both have the <code>jdbc-url</code>, <code>username</code> and <code>password</code> attributes defined: they are required parameters. Any other parameter is optional as it uses <strong><a href="http://vibur.org">Vibur's default values</a></strong>.</p>
<p>The code bellow makes use from the <code>production</code> DataSource.</p>
<pre><code class="java language-java">import kikaha.core.api.*;
import javax.inject.*;
import javax.sql.*;

@Singleton
public class EmployeeSearchService {

  @Inject
  @Named("production") // could be omitted if using the 'default' one.
  DataSource db;

  public void printAllEmployees()
  {
    try (Connection con = ds.getConnection())
    {
      Statement stmt = con.createStatement();
      ResultSet rs = stmt.executeQuery("select empid, name from Employee");

      while(rs.next()){
        String msg = "Employee ID="+rs.getInt("empid")+", Name="+rs.getString("name");
        System.out.println( msg );
      }
    }
  }
}
</code></pre>
<p>You can notice that, in order to inject "production" DataSource, you should specify the source name through the <code>@javax.inject.Named</code> annotation. You will have to use that annotation for every DataSource injection point, except when you intent to inject the <code>default</code> DataSource - in this case, the <code>@Named</code> annotation is optional.</p>
<h2 id="connectionpoolconfigurationparameters">Connection Pool configuration parameters</h2>
<p>Most of <em>Vibur</em>s configuration was brought to the Kikaha Database module and are available to developers use. Bellow is a list of available parameters and its default values. For more informations, please refer to the Vibur's <strong><a href="http://www.vibur.org/#configuration-settings">documentation</a></strong>. </p>
<ul>
<li>pool-initial-size: 10</li>
<li>pool-max-size: 100</li>
<li>pool-fair: true</li>
<li>pool-enable-connection-tracking: false</li>
<li>jdbc-url: </li>
<li>username: "root"</li>
<li>password: "root"</li>
<li>connection-timeout-in-ms: 500</li>
<li>login-timout-in-seconds: 10</li>
<li>acquire-retry-delay-in-ms: 1000</li>
<li>acquire-retry-attempt: 3</li>
<li>connection-idle-limit-in-seconds: 15</li>
<li>validate-timeout-in-seconds: 3</li>
<li>test-connection-query: "isValid"</li>
<li>init-sql: "isValid"</li>
<li>log-query-execution-longer-than-ms: 80</li>
<li>log-stacktrace-for-long-query-execution: true</li>
<li>log-large-resultset: 500</li>
<li>log-stacktrace-for-large-resultset: true</li>
<li>log-connection-longer-than-ms: 100</li>
<li>clear-sql-warnings: false</li>
<li>reset-defaults-after-use: false</li>
<li>default-auto-commit: true</li>
<li>default-read-only: false</li>
<li>statement-cache-max-size: 0</li>
<li>pool-reducer-class: "org.vibur.dbcp.pool.PoolReducer"</li>
<li>reducer-time-interval-in-seconds: 60</li>
<li>reducer-samples: 20</li>
</ul>
</div>

<div class="g-column g-4-12 t-6-12 m-12-12">
<div class="home-about--git-download-block">
<h3>Welcome</h3>
<!-- SIDE BAR -->
<p>WELCOME
<a href="About-kikaha.html">About</a>
<a href="Kikaha-Philosophy.html">Kikaha philosophy</a></p>
<p>GETTING STARTED
<a href="Getting-Started-in-1-Minute.html">Getting started in 1 minute</a>
<a href="Creating-a-Kikaha-maven-project.html">Creating a Kikaha maven project</a>
<a href="Logging-Configuration.html">Logging configuration</a>
<a href="Architecture-Overview.html">Architecture overview</a>
<a href="Configuring-the-server.html">Configuring the server</a></p>
<p>CORE FEATURES
<a href="HTTP-and-HTTPS.html">HTTP and HTTPS</a>
<a href="Routing-static-assets.html">Routing static assets</a>
<a href="Dependency-Injection.html">Dependency injection</a>
<a href="Authentication-and-Authorization.html">Authentication and authorization</a>
<a href="Smart-Routes.html">Smart routes</a></p>
<p>ESSENTIAL MODULES
<a href="uRouting-API.html">μRouting API</a>
<a href="Web-Socket-routing.html">WebSocket Routing</a>
<a href="Database-Access.html">Database Connection Pool</a>
<a href="JSON-with-Jackson.html">JSON with Jackson</a>
<a href="Proto-Buffers.html">Protobuf</a>
<a href="Mustache.html">Mustache Templates</a>
<a href="Rocker-Templates.html">Rocker Templates</a>
<a href="BCrypt.html">BCrypt</a></p>
<p>CLOUD MODULES
<a href="Consul.io.html">Consul.io</a>
<a href="Codahale-Metrics.html">Codahale's Metrics</a>
<a href="Auth0.html">Auth0 Single Sign-On</a>
<a href="uWorkers.html">μWorkers - Actor-like API</a>
<a href="Hazelcast.html">Hazelcast</a></p>
<p>AWS-RELATED MODULES
<a href="AWS-Related-Modules.html">Overview of AWS-Related Modules</a>
<a href="Deploying-Applications-to-AWS.html">Deploying Applications on AWS</a>
<a href="AWS-IAM-Credentials.html">AWS IAM Credentials</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+EC2&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+EC2..html">AWS EC2</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+SQS+Queues&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+SQS+Queues..html">AWS SQS queues</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+CloudWatch+Metrics&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+CloudWatch+Metrics..html">AWS CloudWatch metrics</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+ALB&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+Load+Balacer..html">AWS Application Load Balancer</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+Lambda&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+Lambda+Functions..html">AWS Lambda functions</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+X-RAY&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+X-RAY..html">AWS X-Ray</a></p>
<p>TUTORIALS
<a href="creating-your-first-http-route.html">Creating your first HTTP route</a>
<a href="kikahas-command-line-interface-tool.html">Kikaha's command line interface</a>
<a href="configuring-your-favorite-ide.html">Configuring your favorite IDE</a>
<a href="Kikaha-Wro4j-Integration.html">Wro4j Integration</a></p>
<p>ADVANCED TOPICS
<a href="Creating-Custom-Modules.html">Creating custom modules</a>
<a href="Routing-With-Undertow.html">Routing with Undertow's API</a>
<a href="Creating-Custom-Cloud-Modules.html">Creating custom cloud modules</a></p>
</div>
</div>

</div>
</div>
</div>
</body>
</html>
