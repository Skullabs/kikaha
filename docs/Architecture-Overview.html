<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Learn Git with beginner to advanced Git tutorials on workflows, git commands, git migration and code review.">
<meta name="author" content="Atlassian">
<link rel="canonical" href="https://www.atlassian.com/git"/>
<title>Kikaha documentation</title>
<link rel="stylesheet" href="site.css"/>
<link href="https://fonts.googleapis.com/css?family=Sanchez:200,300,400,600" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Titillium+Web" rel="stylesheet">
<script src="showdown.min.js">
<script src="showdown-github.min.js">
<script>

</script>
</head>
<body class="wac git-home git">
<div class="header">
  <div class="container">
    <span class="k">k</span>
    <h1>Kikaha</h1>
    <a href="https://blog.kikaha.io">blog</a>
    <a href="https://github.com/Skullabs/kikaha">source code</a>
  </div>
</div>

<div class="page-wrap">
<div class="home-section home-about home-start">
<div class="g-row container">

<div class="g-column g-7-12 t-6-12 m-12-12">
<!-- CONTENT -->
<p>When you are designing a software which requires a good performance is important to understand exactly what may happen and be prepared to any surprise. The follow picture will help you to understand exactly what Kikaha does provide on its stack.</p>
<p><img src="https://files.readme.io/UcrKqkkQKYWHi0aNSu6A_Kikaha%20Architecture%20Overview.png" alt="Architecture Overview" /></p>
<p>As you can see Kikaha is just a tiny layer around most of functionalities Undertow has. The blue blocks represents modules that developers may, or not, include on its stack when they are developing an application. Most of these modules has its default properties already set, thus developers could enable (or disable) them as easy as including one - or more - modules as dependency on your project.</p>
<p>Every configuration process is started by the <strong>Module Loader</strong>, provided by the <strong>Kikaha Core Module</strong>. In fact, all steps needed to start and configure Undertow's internals and deploy HTTP routes are split into a few modules which is loaded by the Module Loader. The following picture will show you an overview of Kikaha's Module Lifecycle.</p>
<p><img src="https://files.readme.io/0vwOQPGuTnOTiTEl14W1_Kikaha%20Bootstrap%20Overview.png" alt="Kikaha Bootstrap Overrview" /></p>
<p>The first thing is loaded once you start a Kikaha application is the Dependency Injection Context. It is responsible for look into the ClassPath and pre-load all <strong><a href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html">SPI</a></strong> implementations and Singletons. Once CDI is started all configuration files are loaded and made available for the entire application. Then Module Loader takes place and it will ensure any implementation of <code>kikaha.core.modules.Module</code> interface available on ClassPath will be carefully loaded.</p>
<h2 id="modulesoverview">Modules Overview</h2>
<p>Bellow a basic overview of all modules available out-of-box on Kikaha and you can add it into your project.</p>
<h3 id="configmodule">Config module</h3>
<p>A basic configuration layer which developers are allowed to configure their softwares through human readable YML files.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-config&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="cdimodule">CDI module</h3>
<p>A very tiny Dependency Injection context. It is quite fast once it was designed to retrieve all information required to the injection process during the source code compilation.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-injection&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- required at compilation time only --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-injection-processor&lt;/artifactId&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="corefeatures">Core Features</h3>
<p>Contains the routines that loads all modules, configure all smart routes and start the Undertow server. During this process all CDI elements are read, all Singleton objects and all configuration read from the <em>Classpath</em> are made available to the entire application.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-core&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="mavenplugin">Maven plugin</h3>
<p>Automates a few daily routines a developer may has while using Kikaha such as creating a zip package or running the current project. You can see it in action on the <strong><a href="doc:getting-started-in-1-minute.html">Getting Started guide</a></strong>.</p>
<pre><code class="xml language-xml">&lt;plugin&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-maven-plugin&lt;/artifactId&gt;
&lt;/plugin&gt;
</code></pre>
<h3 id="databasemodule">Database module</h3>
<p>Provide a tiny abstraction over ViburDBCP connection pool. It reads all database configuration and provide a ready-to-inject <code>DataSource</code> object. You can see more about details about this module <strong><a href="doc:database-access.html">here</a></strong>.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-db&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="hazelcastmodule">Hazelcast module</h3>
<p>Automates the most important routines when dealing with Hazelcast Distributed Structures. Also, is the Kikaha's Session Clustering main implementation. There is a Hazelcast topic covering most of its functionalities <strong><a href="doc:hazelcast.html">here</a></strong>.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;!-- on Kikaha's 2.0.x version you should change the artifactId to kikaha-hazelcast --&gt;
  &lt;artifactId&gt;kikaha-cloud-hazelcast&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="microroutinguroutingapi">micro Routing (uRouting) API</h3>
<p>An API heavily inspired on JAX-RS to allow developers map HTTP endpoints through annotations. As happens with CDI routines, it is Reflection-free and provide no overhead at runtime once it converts annotated methods in Undertow routes at compile time.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-urouting&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="jackson">Jackson</h3>
<p>Adds JSON serialization support to the uRouting API through the Jackson library.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-jackson&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="mustache">Mustache</h3>
<p>Renders HTML templates using the Mustache Syntax.</p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-mustache&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h3 id="uworkersapi">uWorkers API</h3>
<p>An actor-like API to handle and distribute high work loads. </p>
<pre><code class="xml language-xml">&lt;dependency&gt;
  &lt;groupId&gt;io.skullabs.kikaha&lt;/groupId&gt;
  &lt;version&gt;PUT-KIKAHA-VERSION-HERE&lt;/version&gt;
  &lt;artifactId&gt;kikaha-uworkers&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<h1 id="dependencies">Dependencies</h1>
<p>Kikaha was designed to be small, and thus, it means its dependency tree was carefully chosen. Bellow are the minimal dependencies you need in order to have a Kikaha application running.</p>
<ul>
<li><strong><a href="http://undertow.io/">Undertow</a></strong> - The main Kikaha's dependency. Basically, Kikaha was developed to be a tiny layer between the developer and Undertow</li>
<li><strong><a href="https://bitbucket.org/asomov/snakeyaml">SnakeYAML</a></strong> - Very simple Yaml parser used for configuration propose only.</li>
<li><strong><a href="http://www.slf4j.org/">SLF4j</a></strong> - The Kikaha's main logger. See <strong><a href="doc:logging-configuration.html">Logging Configuration</a></strong> for more details.</li>
<li><strong><a href="http://download.oracle.com/otndocs/jcp/dependency_injection-1.0-final-oth-JSpec/">JSR-330</a></strong> - Dependency Injection for Java 1.0 Final Release.</li>
</ul>
<h1 id="undertowsinternalarchitecture">Undertow's Internal Architecture</h1>
<p>Undertow is directly responsible for Kikaha's throughput performance. So, to obtain the best performance results from Kikaha we have to understand the Undertow architecture.</p>
<p>Basically, Undertow have three important things:</p>
<ul>
<li>IO Threads - responsible to handle incoming requests</li>
<li>Worker Threads - responsible to handle requests that take too much time</li>
<li>Connectors - responsible to handle different protocols, like HTTP, HTTPS and AJP.</li>
</ul>
<p>Once an HTTP(S) request has arrived in the Undertow connector, an IO Thread handles the connection. It will delegate the connection to your <code>HttpHandler</code>[1] implementation.</p>
<p>The XNIO worker manages both the IO threads, and a thread pool that can be used for blocking tasks. In general non-blocking handlers will run from withing an IO thread, while blocking tasks such as Servlet invocations will be dispatched to the worker thread pool. [2]</p>
<p><a href="http://undertow.io/undertow-docs/undertow-docs-1.2.0/index.html#built-in-handlers">1</a> - More details about Undertow's HttpHandler.<br />
<a href="http://undertow.io/undertow-docs/undertow-docs-1.2.0/index.html#management-of-io-and-worker-threads">2</a> - Management of IO and Worker Threads</p>
<h1 id="improvingtheroutingperformance">Improving the Routing Performance</h1>
<p>Kikaha micro Routing API creates a tiny layer between the developer code and Undertow to avoid repetitive boilerplate code. This layer is generated at compilation time, which makes easy to debug your code and find implementation bugs.</p>
<p>There is no magic code here. Basically it:</p>
<ol>
<li>extract parameters</li>
<li>un-serializes incomming request body</li>
<li>call your route method</li>
<li>serializes you response back</li>
</ol>
<p>Every blocking requests is run under a Worker Thread. Keep in mind that the Worker Thread is configurable through <code>server.undertow.worker-threads</code> parameter at configuration file. The default value is 200.</p>
<p>If you don't plan to use any IO Blocking operation on your route method, we encourage you to use Asynchronous Routing. This will make you request to be handled in the IO Thread. IO Thread is faster, but have limited resources - usually the number of IO Thread is the same of the number of CPU processors available on you server. You can set your own value changing the <code>server.undertow.io-threads</code> parameter on your configuration file (default is <code>-1</code> - setting to the number of CPU processors on the server).</p>
<p>Also, you can set custom Undertow and XNIO (the IO backend used by Undertow) parameters to improve the application performance. All Undertow options can be set at <code>server.undertow.server-options</code>. XNIO options can be set at <code>server.undertow.socket-options</code>. All available options are better described <strong><a href="http://undertow.io/undertow-docs/undertow-docs-1.2.0/index.html#common-listener-options">here</a></strong>, at the Undertow documentation.</p>
<p>Bellow is a configuration file that configures Kikaha to behave exactly as Undertow was <strong><a href="https://github.com/TechEmpower/FrameworkBenchmarks/blob/master/frameworks/Java/undertow/src/main/java/hello/HelloWebServer.java">configured</a></strong> to the <strong><a href="https://www.techempower.com/benchmarks/#section=data-r10&hw=ec2&test=plaintext">Techempower Performance Benchmark</a></strong>.</p>
<pre><code class="yml language-yml">server:
  undertow:
    io-threads: -1
    worker-threads: 200
    buffer-size: 16384 # 1024*16

    socket-options:
      BACKLOG: 10000

    server-options:
      ALWAYS_SET_KEEP_ALIVE: false
      ALWAYS_SET_DATE: true
      ENABLE_CONNECTOR_STATISTICS: false
      RECORD_REQUEST_START_TIME: false
</code></pre>
</div>

<div class="g-column g-4-12 t-6-12 m-12-12">
<div class="home-about--git-download-block">
<h3>Welcome</h3>
<!-- SIDE BAR -->
<p>WELCOME
<a href="About-kikaha.html">About</a>
<a href="Kikaha-Philosophy.html">Kikaha philosophy</a></p>
<p>GETTING STARTED
<a href="Getting-Started-in-1-Minute.html">Getting started in 1 minute</a>
<a href="Creating-a-Kikaha-maven-project.html">Creating a Kikaha maven project</a>
<a href="Logging-Configuration.html">Logging configuration</a>
<a href="Architecture-Overview.html">Architecture overview</a>
<a href="Configuring-the-server.html">Configuring the server</a></p>
<p>CORE FEATURES
<a href="HTTP-and-HTTPS.html">HTTP and HTTPS</a>
<a href="Routing-static-assets.html">Routing static assets</a>
<a href="Dependency-Injection.html">Dependency injection</a>
<a href="Authentication-and-Authorization.html">Authentication and authorization</a>
<a href="Smart-Routes.html">Smart routes</a></p>
<p>ESSENTIAL MODULES
<a href="uRouting-API.html">μRouting API</a>
<a href="Web-Socket-routing.html">WebSocket Routing</a>
<a href="Database-Access.html">Database Connection Pool</a>
<a href="JSON-with-Jackson.html">JSON with Jackson</a>
<a href="Proto-Buffers.html">Protobuf</a>
<a href="Mustache.html">Mustache Templates</a>
<a href="Rocker-Templates.html">Rocker Templates</a>
<a href="BCrypt.html">BCrypt</a></p>
<p>CLOUD MODULES
<a href="Consul.io.html">Consul.io</a>
<a href="Codahale-Metrics.html">Codahale's Metrics</a>
<a href="Auth0.html">Auth0 Single Sign-On</a>
<a href="uWorkers.html">μWorkers - Actor-like API</a>
<a href="Hazelcast.html">Hazelcast</a></p>
<p>AWS-RELATED MODULES
<a href="AWS-Related-Modules.html">Overview of AWS-Related Modules</a>
<a href="Deploying-Applications-to-AWS.html">Deploying Applications on AWS</a>
<a href="AWS-IAM-Credentials.html">AWS IAM Credentials</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+EC2&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+EC2..html">AWS EC2</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+SQS+Queues&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+SQS+Queues..html">AWS SQS queues</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+CloudWatch+Metrics&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+CloudWatch+Metrics..html">AWS CloudWatch metrics</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+ALB&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+Load+Balacer..html">AWS Application Load Balancer</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+Lambda&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+Lambda+Functions..html">AWS Lambda functions</a>
<a href="https://github.com/Skullabs/kikaha/issues/new?labels=documentation&title=AWS+X-RAY&body=It+would+be+great+to+have+a+detailed+documentation+about+AWS+X-RAY..html">AWS X-Ray</a></p>
<p>TUTORIALS
<a href="creating-your-first-http-route.html">Creating your first HTTP route</a>
<a href="kikahas-command-line-interface-tool.html">Kikaha's command line interface</a>
<a href="configuring-your-favorite-ide.html">Configuring your favorite IDE</a>
<a href="Kikaha-Wro4j-Integration.html">Wro4j Integration</a></p>
<p>ADVANCED TOPICS
<a href="Creating-Custom-Modules.html">Creating custom modules</a>
<a href="Routing-With-Undertow.html">Routing with Undertow's API</a>
<a href="Creating-Custom-Cloud-Modules.html">Creating custom cloud modules</a></p>
</div>
</div>

</div>
</div>
</div>
</body>
</html>
